<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:smtk="http://java.sun.com/jsf/composite/smtk"
                template="/WEB-INF/template/template.xhtml">

    <ui:define name="content">

        <p:panel id="createEdit">
            <h:form id="mainForm" rendered="#{newConceptMBean.concept!=null}">

                <p:growl id="growl" showDetail="true" showSummary="true"/>
                <p:growl id="editMsgs" showDetail="true"/>
                <!--p:messages autoUpdate="true"></p:messages-->

                <div class="ui-g">
                    <div class="ui-g-12 ui-md-6 ui-lg-1">
                        <p:outputLabel for="toBeReviewedCheck" value="Indicadores"/>
                    </div>
                    <div class="ui-g-12 ui-md-6 ui-lg-5">
                        <p:selectBooleanCheckbox id="toBeReviewedCheck" itemLabel="Revisar" value="#{newConceptMBean.concept.toBeReviewed}" style="width:40%" />
                        <p:selectBooleanCheckbox id="toBeConsultatedCheck" itemLabel="Consultar" value="#{newConceptMBean.concept.toBeConsulted}" style="width:40%" />
                    </div>
                    <div class="ui-g-12 ui-md-6 ui-lg-3">
                    </div>
                    <div class="ui-g-12 ui-md-6 ui-lg-3">
                    </div>
                </div>

                <smtk:description description="#{newConceptMBean.concept.getValidDescriptionFSN()}">
                </smtk:description>

                <smtk:description description="#{newConceptMBean.concept.getValidDescriptionFavorite()}">
                </smtk:description>

                <smtk:descriptions descriptions="#{newConceptMBean.concept.getValidDescriptionsButFSNandFavorite()}"
                                   otherTermino="#{newConceptMBean.otherTermino}"
                                   otherSensibilidad="#{newConceptMBean.otherSensibilidad}"
                                   otherDescriptionType="#{newConceptMBean.otherDescriptionType}"
                                   descriptionTypes="#{newConceptMBean.descriptionTypes}">
                </smtk:descriptions>

                <!--Relaciones -->
                <p:panel id="atributos" header="Atributos" toggleable="true" toggleSpeed="500" closeSpeed="500"
                         widgetVar="panelAtributos" style="margin-bottom:20px" >

                    <h:dataTable style="width: 100%;" value="#{newConceptMBean.category.relationshipDefinitions}"
                                 var="relationshipDefinition">

                        <h:column>

                            <smtk:smtkType
                                    rendered="#{relationshipDefinition.targetDefinition.SMTKType}"
                                    targetDefinition="#{relationshipDefinition.targetDefinition}"
                                    relationshipDefinition="#{relationshipDefinition}"
                                    concept="#{newConceptMBean.concept}"/>

                            <smtk:helperTableType
                                    rendered="#{relationshipDefinition.targetDefinition.helperTable}"
                                    relationshipDefinition="#{relationshipDefinition}"
                                    targetDefinition="#{relationshipDefinition.targetDefinition}"
                                    concept="#{newConceptMBean.concept}"  />

                            <smtk:basicType
                                    targetDefinition="#{relationshipDefinition.targetDefinition}"
                                    relationshipDefinition="#{relationshipDefinition}"
                                    concept="#{newConceptMBean.concept}"
                                    rendered="#{relationshipDefinition.targetDefinition.basicType}" />

                        </h:column>

                    </h:dataTable>


                </p:panel>


                <p:commandButton actionListener="#{newConceptMBean.saveConcept}" value="Guardar" type="submit" update="growl, mainForm"

                />

            </h:form>

            <p:messages id="msg" showDetail="true" showSummary="true">
                <p:effect type="pulsate" event="load" delay="0">
                    <f:param name="mode" value="'show'"/>
                    <f:param name="times" value="'1'"/>
                </p:effect>
            </p:messages>


            <p:confirmDialog id="dialogNameConcept" header="Crear Concepto" widgetVar="dialogNameConcept" global="true"
                             showEffect="fade" hideEffect="fade" closable="false"
                             rendered="#{newConceptMBean.concept==null}">
                <h:form id="initialForm" >
                    <h:outputText value="Ingrerse el nombre de su concepto:"/>
                    <div class="ui-g">
                        <div class="ui-g-12 ui-md-6 ui-lg-12">
                            <p:outputLabel value="Nombre: " for="NameConcept"/>
                            <p:inputText id="NameConcept" value="#{newConceptMBean.favoriteDescription}"/>
                        </div>
                    </div>
                    <p:commandButton actionListener="#{newConceptMBean.createConcept}" update=":createEdit"
                                     value="Siguiente" onclick="loadAutogenerate()"

                    />

                </h:form>
            </p:confirmDialog>
        </p:panel>


        <script type="text/javascript">

            function loadAutogenerate(){

                setTimeout(function() {
                    autogenerate(document.getElementById('initialForm:NameConcept'));
                }, 1000);
            }
            function autogenerate(favorite){
                categoryName= "#{newConceptMBean.category.name}";
                document.getElementById('mainForm:FSN').value=favorite.value+' ('+categoryName+')';


            }

        </script>

    </ui:define>

</ui:composition>