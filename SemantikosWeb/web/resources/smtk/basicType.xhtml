<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:composite="http://java.sun.com/jsf/composite"
      xmlns:p="http://primefaces.org/ui">

<composite:interface>
    <composite:attribute name="relationshipDefinition" type="cl.minsal.semantikos.model.relationships.RelationshipDefinition" />
    <composite:attribute name="targetDefinition" type="cl.minsal.semantikos.model.basictypes.BasicTypeDefinition" />
    <composite:attribute name="concept" type="cl.minsal.semantikos.model.ConceptSMTK" />
</composite:interface>
<composite:implementation>
    <p:panel
         id="basicTypeSimple"
         widgetVar="panelBasicTypeSimple#{cc.attrs.relationshipDefinition.id}"
         rendered="#{cc.attrs.relationshipDefinition.multiplicity.collection}">
            <div class="ui-g">
                <div class="ui-g-12 ui-md-6 ui-lg-12">
                    <p:commandButton
                            id="addRelationshipButton"
                            update=":#{cc.clientId}:basicTypeSimple"
                            value="Agregar"
                            style="float: right"
                            process="@this"
                            action="#{newConceptMBean.addRelationship(cc.attrs.relationshipDefinition)}"
                            rendered="#{!cc.attrs.relationshipDefinition.multiplicity.isUpperBoundaryReached(cc.attrs.concept.getRelationshipsByRelationDefinition(cc.attrs.relationshipDefinition).size())}">
                    </p:commandButton>
                </div>
            </div>
            <div class="ui-g">
                <div class="ui-g-12 ui-md-6 ui-lg-12">
                    <p:dataTable value="#{cc.attrs.concept.getRelationshipsByRelationDefinition(cc.attrs.relationshipDefinition)}"
                                 var="relationship"
                                 rowIndexVar="var"
                                 >
                        <p:column style="width:10%">
                            <div style="text-align: left;">
                                <p:outputLabel for="basicTypeValue" value="#{cc.attrs.relationshipDefinition.name}"/>
                            </div>
                        </p:column>
                        <p:column >
                            <p:selectOneMenu id="basicTypeValue"
                                             value="#{relationship.target.value}"
                                             var="value1"
                                             converter="omnifaces.SelectItemsConverter"
                                             styleClass="ui-inputfield"
                                             rendered="#{cc.attrs.targetDefinition.hasDomain}"
                                             required="#{cc.attrs.relationshipDefinition.multiplicity.isRequired(var)}">
                                <f:selectItem itemLabel="Seleccione"
                                              itemValue=""
                                />
                                <f:selectItems value="#{cc.attrs.targetDefinition.domain}"
                                               var="domain"
                                               itemLabel="#{domain}"
                                               itemValue="#{domain}"/>
                            </p:selectOneMenu>
                            <p:inputNumber id="basicTypeValue2"
                                           value="#{relationship.target.value}"
                                           var="value"
                                           minValue="#{cc.attrs.targetDefinition.interval.lowerBoundary}"
                                           maxValue="#{cc.attrs.targetDefinition.interval.upperBoundary}"
                                           decimalPlaces="0"
                                           decimalSeparator=","
                                           thousandSeparator="."
                                           required="#{cc.attrs.relationshipDefinition.multiplicity.isRequired(var)}"
                                           rendered="#{cc.attrs.targetDefinition.integer}">
                            </p:inputNumber>
                            <p:inputNumber id="basicTypeValue3"
                                           value="#{relationship.target.value}"
                                           var="value"
                                           minValue="#{cc.attrs.targetDefinition.interval.lowerBoundary}"
                                           maxValue="#{cc.attrs.targetDefinition.interval.upperBoundary}"
                                           decimalSeparator=","
                                           thousandSeparator="."
                                           decimalPlaces="2"
                                           required="#{cc.attrs.relationshipDefinition.multiplicity.isRequired(var)}"
                                           rendered="#{cc.attrs.targetDefinition.float}">
                            </p:inputNumber>
                            <p:inputText id="basicTypeValue4"
                                         value="#{relationship.target.value}"
                                         var="value"
                                         minValue="#{cc.attrs.targetDefinition.interval.lowerBoundary}"
                                         maxValue="#{cc.attrs.targetDefinition.interval.upperBoundary}"
                                         required="#{cc.attrs.relationshipDefinition.multiplicity.isRequired(var)}"
                                         rendered="#{cc.attrs.targetDefinition.string}">
                            </p:inputText>
                            <p:calendar id="basicTypeValue5"
                                        value="#{relationship.target.value}"
                                        var="value"
                                        showOn="button"
                                        mindate="#{cc.attrs.targetDefinition.interval.lowerBoundary}"
                                        maxdate="#{cc.attrs.targetDefinition.interval.upperBoundary}"
                                        required="#{cc.attrs.relationshipDefinition.multiplicity.isRequired(var)}"
                                        rendered="#{cc.attrs.targetDefinition.date}">
                            </p:calendar>
                            <p:commandButton
                                    icon="fa fa-trash" title="Eliminar"
                                    update="#{cc.clientId}:basicTypeSimple"
                                    styleClass="ui-datepicker-trigger ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only"
                                    process="@this"
                                    actionListener="#{newConceptMBean.removeRelationship(cc.attrs.relationshipDefinition, relationship)}"
                                    rendered="#{!cc.attrs.relationshipDefinition.multiplicity.isRequired(var) and var>0}"
                            >
                            </p:commandButton>
                        </p:column>
                    </p:dataTable>
                </div>
            </div>
    </p:panel>

    <h:outputStylesheet id="customCSS">
        .ui-selectonemenu .ui-selectonemenu-label {
            overflow: visible;
        }
    </h:outputStylesheet>


</composite:implementation>
</html>
