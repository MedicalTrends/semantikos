<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:composite="http://java.sun.com/jsf/composite"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://java.sun.com/jsp/jstl/core">

<composite:interface>
    <composite:attribute name="descriptions" type="java.util.List" />
    <composite:attribute name="otherTermino" type="java.lang.String" />
    <composite:attribute name="otherSensibilidad" type="java.lang.Boolean" />
    <composite:attribute name="otherDescriptionType" type="cl.minsal.semantikos.model.DescriptionType" />
    <composite:attribute name="descriptionTypes" type="java.util.List" />
</composite:interface>

<composite:implementation>

    <p:panel id="otherDescriptionsPanel" styleClass="otherDescriptionsPanel"
             header="Otros Descriptores" toggleable="true" toggleSpeed="500" closeSpeed="500"
             widgetVar="panel">

        <p:growl id="growl" showDetail="true" showSummary="true"/>
        <p:growl id="editMsgs" showDetail="true"/>

        <p:fieldset legend="Agregar descripción" toggleable="true" collapsed="true">
            <div class="ui-g">
                <div class="ui-g-12 ui-md-6 ui-lg-1">
                    <p:outputLabel for="otherTermino" value="Termino"/>
                </div>

                <div class="ui-g-12 ui-md-6 ui-lg-5">
                    <p:inputText id="otherTermino" value="#{cc.attrs.otherTermino}" style="width:90%"/>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-3">
                    <p:selectOneRadio id="radio4" value="#{cc.attrs.otherSensibilidad}" layout="responsive"
                                      columns="2" style="width:100%">
                        <f:selectItem itemValue="#{true}" itemLabel="Sensible"/>
                        <f:selectItem itemValue="#{false}" itemLabel="Insensible"/>
                    </p:selectOneRadio>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-2">
                    <p:selectOneMenu id="console" value="#{cc.attrs.otherDescriptionType}"
                                     converter="omnifaces.SelectItemsConverter" style="width:70%">
                        <f:selectItem itemLabel="Seleccione tipo" itemValue=""/>
                        <f:selectItems value="#{cc.attrs.descriptionTypes}" var="descriptionType"
                                       itemLabel="#{descriptionType.name}" itemValue="#{descriptionType}"/>
                    </p:selectOneMenu>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-1">
                    <p:commandButton value="Agregar" id="btn" action="#{conceptBean.addDescription()}"
                                     process="@(.otherDescriptionsPanel)"
                                     update="@(.otherDescriptionsPanel)"
                                     style="float: right"/>
                </div>
            </div>

        </p:fieldset>
        <p:spacer />
        <div class="ui-g">
            <p:dataTable id="otherDescriptions"
                         styleClass="otherDescriptions"
                         var="description"
                         value="#{cc.attrs.descriptions}"
                         editable="true"
                         selection="#{conceptBean.selectedDescriptions}"
                         rowKey="#{description.id}"
                         reflow="true">

                <p:column selectionMode="multiple" style="width:16px;text-align:center"/>

                <!--Columnas por defecto -->

                <p:column headerText="DescId" style="width:5%">
                    <div style="text-align: center;">
                        <h:outputText value="-"/>
                    </div>
                </p:column>

                <p:column headerText="Término" >
                    <div style="text-align: center;">
                        <p:cellEditor>
                            <f:facet  name="output"><h:outputText value="#{description.representation}"/></f:facet>
                            <f:facet  name="input"><p:inputText id="otrasTermino"
                                                                value="#{description.representation}"
                                                                style="width:100%"/></f:facet>
                        </p:cellEditor>
                    </div>
                </p:column>

                <p:column headerText="Estado" >
                    <div style="text-align: center;">
                        <p:cellEditor>
                            <f:facet name="output">
                                <h:outputText value="Borrador" rendered="#{not description.modeled}"/>
                                <h:outputText value="Modelado" rendered="#{description.modeled}"/>
                            </f:facet>
                            <f:facet name="input">
                                <p:selectOneMenu value="#{description.modeled}" style="width:60%">
                                    <f:selectItem itemLabel="Seleccione estado" itemValue=""/>
                                    <f:selectItem itemLabel="Borrador" itemValue="false"/>
                                    <f:selectItem itemLabel="Modelado" itemValue="true"/>
                                </p:selectOneMenu>
                            </f:facet>
                        </p:cellEditor>
                    </div>
                </p:column>

                <p:column headerText="Tipo Descriptor">
                    <div style="text-align: center;">
                        <p:cellEditor>
                            <f:facet name="output"><h:outputText
                                    value="#{description.descriptionType}"/></f:facet>
                            <f:facet name="input">
                                <p:selectOneMenu value="#{description.descriptionType}"
                                                 converter="omnifaces.SelectItemsConverter" style="width:60%">
                                    <f:selectItem itemLabel="Seleccione tipo" itemValue=""/>
                                    <f:selectItems value="#{conceptBean.descriptionTypes}"
                                                   var="descriptionType" itemLabel="#{descriptionType.name}"
                                                   itemValue="#{descriptionType}"/>
                                </p:selectOneMenu>
                            </f:facet>
                        </p:cellEditor>
                    </div>
                </p:column>

                <p:column headerText="Fecha Creación">
                    <div style="text-align: center;">
                        <h:outputText />
                    </div>
                </p:column>

                <p:column headerText="Sensibilidad">
                    <div style="text-align: center;">
                        <p:cellEditor>
                            <f:facet name="output">
                                <h:outputText value="Sensible" rendered="#{description.caseSensitive}"/>
                                <h:outputText value="Insensible" rendered="#{!description.caseSensitive}"/>
                            </f:facet>
                            <f:facet name="input">
                                <p:selectOneMenu value="#{description.caseSensitive}" style="width:60%">
                                    <f:selectItem itemValue="#{true}" itemLabel="Sensible"/>
                                    <f:selectItem itemValue="#{false}" itemLabel="Insensible"/>
                                </p:selectOneMenu>
                            </f:facet>
                        </p:cellEditor>
                    </div>
                </p:column>

                <p:column headerText="Usuario Creador">
                    <div style="text-align: center;">
                        <h:outputText />
                    </div>
                </p:column>

                <p:column headerText="Acción" style="width:4%">
                    <p:commandLink actionListener="#{conceptBean.removeDescription(description)}"
                                   ajax="true"
                                   process="@this"
                                   update="@(.otherDescriptions)" style="float: right">
                        <h:graphicImage  style="width: 15px; height: 15px"
                                         name="images/trash-blue.png"
                        />
                    </p:commandLink>
                    <p:commandButton rendered="#{conceptBean.concept.persistent}"
                                     icon="fa fa-exchange"
                                     process="@this"
                                     update="@(.otherDescriptions)"
                                     oncomplete="PF('dialogTDC').show()"
                    />
                    <p:rowEditor style="display: inline" />
                </p:column>

            </p:dataTable>
        </div>
    </p:panel>


    <p:dialog id="dialogTDC" header="Trasladar descripcion" widgetVar="dialogTDC" global="true"
    showEffect="fade" hideEffect="fade" >
        <div class="ui-g">
            <div class="ui-g-12 ui-md-6 ui-lg-6">
                <p:panel header="Origen" style="width: 100%;">

                </p:panel>
            </div>
            <div class="ui-g-12 ui-md-6 ui-lg-6">
                <p:panel header="Destino" style="width: 100%;">
                    <div class="ui-g">
                    <div class="ui-grid-col-6">
                        <p:autoComplete id="inputFindConcept" scrollHeight="200" size="5" style="width: 80%;"
                                        inputStyle="width: 80%;"
                                        converter="conceptConverter" var="concept"
                                        value="#{findConceptBean.conceptSMTK}"
                                        completeMethod="#{findConceptBean.getConceptSearchInput}"
                                        itemLabel="#{concept.descriptionFavorite.term}" itemValue="#{concept}"
                                        emptyMessage="No se encontraron conceptos relacionados"
                        >
                        </p:autoComplete>
                    </div>

                    <div class="ui-grid-col-6">
                    </div>
                    </div>

                </p:panel>
            </div>
        </div>
        <div style="text-align: center;">
            <p:commandButton icon="fa fa-exchange" value="Trasladar">

            </p:commandButton>
        </div>

    </p:dialog>

</composite:implementation>
</html>
